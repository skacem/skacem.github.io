<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Customer Segmentation using RFM Analysis</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="">
    <link rel="canonical" href="/ml/2021/10/25/Customer-Segmentation-BA2/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-96x96.png">

    <!--flattr.com -->
    <meta name="flattr:id" content="nlxxeo">

    <!-- Stuff added for BibTex dropdown menu -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

        <!--KaTeX-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
        <script>
         document.addEventListener("DOMContentLoaded", function() {
             renderMathInElement(document.body, {
                 // ...options...
             });
         });
        </script>
        
</head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MJT6KHN3F1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MJT6KHN3F1');
</script>
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" rel="stylesheet">

    <body>
    <a name="top"></a>
    <header class="site-header">
  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
      <a href="/about/">
    <img src="/sk.png" width="45">
  </a>
  </div>

    <a class="site-title site-link" href="/about/">Skander Kacem</a> <br>
    <p class="site-subtitle" style="font-style: italic; text-align: center;">Thinking out loud</p>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="site-link" href="/thoughts/">Thoughts</a>
        <a class="site-link" href="/readings/">Readings</a>
        <a class="site-link" href="/notes/">Notes</a>
      </div>
    </nav>
  </div>
</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Customer Segmentation using RFM Analysis</h1>
    <div class="post-meta">
      <div class="post-date">
        <i class="fa fa-calendar-o"></i>
        2021-10-25
      </div>
      <div class="post-tags">
        <i class="fa fa-tags"></i>
        
          <span><a href="/tag/Business Analytics"><code class="highligher"><nobr>Business Analytics</nobr></code></a></span>
        
          <span><a href="/tag/Tutorial"><code class="highligher"><nobr>Tutorial</nobr></code></a></span>
        
          <span><a href="/tag/Hierarchical Cluster Analysis"><code class="highligher"><nobr>Hierarchical Cluster Analysis</nobr></code></a></span>
        
          <span><a href="/tag/Customer Segmentation"><code class="highligher"><nobr>Customer Segmentation</nobr></code></a></span>
        
      </div>
    </div>
  </header>

  <article class="post-content">
  <h2 id="introduction">Introduction</h2>

<p>The field of marketing analytics is very broad and can include fascinating topics such as:</p>

<ul>
  <li>Text mining,</li>
  <li>Social network analysis,</li>
  <li>sentiment analysis,</li>
  <li>realtime bidding and so on.</li>
</ul>

<p>However, at the heart of marketing lie few basic questions, that often remain unanswered:</p>

<ol>
  <li>Who are my customers?</li>
  <li>Which customers should I target, and spend most of my marketing budget on?</li>
  <li>What is the future value of my customers?</li>
</ol>

<p>In this tutorial, we will explore the first two questions using customer segmentation techniques involving RFM analysis along with HCA.</p>

<h2 id="customer-segmentation">Customer Segmentation</h2>

<p>You can’t treat your customers the same way, offer them the same product, charge the same price, or communicate the same benefits. Otherwise you will miss a lot of value. So you need to understand the distinctions in your customers’ needs, wants, preferences and behaviors. Only then can you customize your offering, personalize your customer approach, and optimize your marketing campaigns.</p>

<p>Now, in today’s digital world, almost every online retailer holds a massive customer database. So, how do we deal with big customer databases?<br />
Treating each and every customer individually is very costly. The answer is, of course, segmentation. I know, you’ve already guessed that yourselves.</p>

<p>A great segmentation is all about finding a good balance between simplifying enough, so it remains usable and not simplifying too much, so it’s still statistically and managerially relevant.</p>

<h2 id="rfm-analysis">RFM Analysis</h2>

<p>RFM (Recency, Frequency, Monetary) analysis is a segmentation approach based on customer behavior. It groups customers according to their purchasing history (How recently, how frequently, and how much has a customer spent on past purchases).  It is one of the best predictor of future purchase and customer lifetime value in terms of their activity and engagement.</p>

<p>Recency indicates when a customer made his or her last purchase. Usually the smaller the recency, that is the more recent the last purchase, the more likely the next purchase will happen soon. On the other hand, if a customer has lapsed and has not made any purchase for a long period of time, he may have lost interest or switched to competition.<br />
Frequency is about the number of customers purchases in a given period of time. Customers who bought frequently were more likely to buy again, as opposed to customers who made only one or two purchases.<br />
Monetary is about how much a customer has spent in total during a given period. Customers who spend more should be treated differently than customers who spend less. Furthermore, they are more likely to buy again.</p>

<h2 id="practical-example-in-python">Practical Example in Python</h2>

<p>We start by loading the required libraries and the dataset, and set up our programming environment. Also, make sure you have <code class="language-plaintext highlighter-rouge">pandassql</code> and <code class="language-plaintext highlighter-rouge">squarify</code> installed.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">pandasql</span> <span class="kn">import</span> <span class="n">sqldf</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>
<span class="kn">from</span> <span class="n">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span>
<span class="kn">from</span> <span class="n">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span> <span class="p">,</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">cut_tree</span>
<span class="kn">import</span> <span class="n">squarify</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Notebooks set up
</span><span class="n">pysqldf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="nf">sqldf</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nf">globals</span><span class="p">())</span>
<span class="o">%</span><span class="n">precision</span> <span class="o">%</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span>
<span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="sh">'</span><span class="s">{:,.2f}</span><span class="sh">'</span><span class="p">.</span><span class="nb">format</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="sh">"</span><span class="s">figure.figsize</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># read the dataset from the csv file
</span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">purchase_amount</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">date_of_purchase</span><span class="sh">'</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">../Datasets/purchases.txt</span><span class="sh">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                 <span class="n">names</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="data-wrangling">Data Wrangling</h3>

<p>The dataframe consists of 51,243 observations across 3 variables:</p>

<ol>
  <li>Customer ID,</li>
  <li>purchase amount in USD and</li>
  <li>date of purchase</li>
</ol>

<p>The data is clean and covers the period January 2nd 2005 to December 31st 2015.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 51243 entries, 0 to 51242
Data columns (total 3 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   customer_id       51243 non-null  int64  
 1   purchase_amount   51243 non-null  float64
 2   date_of_purchase  51243 non-null  object 
dtypes: float64(1), int64(1), object(1)
memory usage: 1.2+ MB
</code></pre></div></div>

<p>We proceed by converting the <code class="language-plaintext highlighter-rouge">data_of_purchase</code> column from object to a date object.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Transform the last column to a date object
</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">date_of_purchase</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">date_of_purchase</span><span class="sh">'</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="sh">'</span><span class="s">%Y-%m-%d</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p>To calculate the recency, we create a new variable <code class="language-plaintext highlighter-rouge">day_since</code> that contains the number of days since the last purchase. To do this, we set January 1, 2016 as the start date and count the number of days since the last purchase for each customer backwards using the customers ID.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Extract year of purchase and save it as a column
</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">year_of_purchase</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">date_of_purchase</span><span class="sh">'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">year</span>
<span class="c1"># Add a day_since column showing the difference between last purchase and a basedate
</span><span class="n">basedate</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Timestamp</span><span class="p">(</span><span class="sh">'</span><span class="s">2016-01-01</span><span class="sh">'</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">days_since</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">basedate</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">date_of_purchase</span><span class="sh">'</span><span class="p">]).</span><span class="n">dt</span><span class="p">.</span><span class="n">days</span>
</code></pre></div></div>

<h3 id="rfm-computation">RFM Computation</h3>

<p>To implement the RFM analysis, further data processing need to be done.<br />
Next we are going to compute the customers recency, frequency and average purchase amount. This part is a bit tricky, particularly when implemented with pandas. The trick here is that the customer ID is unique for each customer. So even though we have 51,243 purchases, we will only have as many unique customer IDs as there are in the database. <br />
For each customer, we now need to calculate the minimum number of days between all of their purchases and January 1, 2016. By taking the minimum number of days, we obviously have the day of the last purchase, which is the exact definition of recency. <br />
The next step is to calculate the frequency for each customer, namely how many purchases this customer has made.<br />
This is achieved with the python sql module:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Compute recency, frequency, and average purchase amount
</span><span class="n">q</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
        SELECT customer_id,
        MIN(days_since) AS </span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="s">,
        COUNT(*) AS </span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="s">,
        AVG(purchase_amount) AS </span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="s">
        FROM df GROUP BY 1</span><span class="sh">"""</span>
<span class="n">customers</span> <span class="o">=</span> <span class="nf">sqldf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</code></pre></div></div>

<p>The asterisk here actually refers to anything in the data that is related to this customer; and then for the amount, we averaged the purchase amount for that specific customer ID and named that aggregate calculation as <code class="language-plaintext highlighter-rouge">amount</code>.<br />
Now, the trick is we want to make sure that each row only appears once per customer. So we’re going to calculate that from the data and group by one, which means that everything here is going to be calculated and grouped by customer ID.</p>

<p>Sure, it would have been possible to do all the computations with pandas only. However, this would have required much more work. When working with databases, SQL knowledge is an advantage. Indeed, a single sql command is all that is needed to create an RFM table.<br />
The results are then stored under the variable <code class="language-plaintext highlighter-rouge">customers</code> and the first five entries have the following values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">customers</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+---------------+-----------+-------------+----------+
|    |   customer_id |   recency |   frequency |   amount |
|----+---------------+-----------+-------------+----------|
|  0 |            10 |      3829 |           1 |       30 |
|  1 |            80 |       343 |           7 |  71.4286 |
|  2 |            90 |       758 |          10 |    115.8 |
|  3 |           120 |      1401 |           1 |       20 |
|  4 |           130 |      2970 |           2 |       50 |
+----+---------------+-----------+-------------+----------+
</code></pre></div></div>

<h3 id="exploratory-data-analysis">Exploratory Data Analysis</h3>

<p>We start by generating some descriptive statistics, including those that summarize the central tendency, dispersion and shape of each of our RFM variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">customers</span><span class="p">[[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">]].</span><span class="nf">describe</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------+-----------+-------------+----------+
|       |   recency |   frequency |   amount |
|-------+-----------+-------------+----------|
| count |     18417 |       18417 |    18417 |
| mean  |   1253.04 |     2.78237 |   57.793 |
| std   |   1081.44 |     2.93689 |   154.36 |
| min   |         1 |           1 |        5 |
| 25%   |       244 |           1 |  21.6667 |
| 50%   |      1070 |           2 |       30 |
| 75%   |      2130 |           3 |       50 |
| max   |      4014 |          45 |     4500 |
+-------+-----------+-------------+----------+
</code></pre></div></div>

<p>Then we plot the distributions of the RFM variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Plot the recency distribution
</span><span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="sh">'</span><span class="s">seaborn-whitegrid</span><span class="sh">'</span><span class="p">)</span>
<span class="n">customers</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Customers</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Days Since Last Purchase</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/recency.png" style="zoom:100%;" />
<div class="thecap">  </div></div>

<p>Except for a peak on the very left, the recency distribution is relatively uniform. This is good to see, because it means that our business has been gaining attention lately and has been generating record sales. It’s always worth doing a detailed analysis when it comes to outliers or exceptions. So I recommend taking a closer look at this peak to determine its triggers and drivers. It could be that our last marketing campaign was a success or that the pop-up sale we had recently was the consequence. So try to figure out the reason for this and take advantage of it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Plot the frequency distribution
</span><span class="n">customers</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">41</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Customers</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Number of Purchases</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/frequency.png" style="zoom:100%;" />
<div class="thecap">  </div></div>

<p>The frequency distribution is extremely skewed to the right. Almost 50% of all customers have only made one purchase. Again, further clarification is necessary here. It is possible that most one-time purchases are recent, first-time transactions. And with a marketing approach tailored to the relevant customer segments, we could encourage these customers to make their next purchase.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">customers</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">601</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Customers</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Average Amount in $</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/amount.png" style="zoom:100%;" />
<div class="thecap">  </div></div>

<p>Due to the presence of some extreme outliers, it is preferable to use the median here. 50% of all transactions are between $5 and $30.</p>

<p>This was a small overview of how to conduct an exploratory data analysis. Usually, at this stage of analysis, we develop hypotheses that we want to test later, especially with respect to ambiguous relationships such as finding out if it involves correlation or causation. Therefore, it is best to spend a little more time exploring your dataset.</p>

<p>Lets now move on to customer segmentation.</p>

<h3 id="hierarchical-cluster-analysis">Hierarchical Cluster Analysis</h3>

<p>Before starting the data transformation it is better to keep a copy of the original data, in case something goes wrong.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Copy the dataset
</span><span class="n">new_data</span> <span class="o">=</span> <span class="n">customers</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
<span class="n">new_data</span><span class="p">.</span><span class="nf">set_index</span><span class="p">(</span><span class="sh">'</span><span class="s">customer_id</span><span class="sh">'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Data preprocessing is an essential part of segmentation and ML algorithms in general. We need to prepare and transform our data, so the segmentation variables can be compared to one another.</p>

<p>Since our segmentation variables don’t use the same scales, we need to standardize them. In statistics, standardization means to subtract the mean and divide by the standard deviation:</p>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>r</mi><mi>d</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mi>D</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>−</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mtext> </mtext><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow><mrow><mi>D</mi><mi>a</mi><mi>t</mi><mi>a</mi><mtext> </mtext><mi>s</mi><mi>t</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>a</mi><mi>r</mi><mi>d</mi><mtext> </mtext><mi>d</mi><mi>e</mi><mi>v</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Standardize=\frac{Data - data~mean}{Data~standard~deviation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">St</span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mspace nobreak"> </span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">ia</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mspace nobreak"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">an</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>Regardless of what the original scale was, days, dollars, or number of purchases, they can now be related to one another.</p>

<p>Another problem to deal with is the dispersion or skewness of data. Skewness indicates the direction and relative magnitude of a distribution’s deviation from the normal distribution. In the figure above, we see that the average purchase amount in $ is right skewed, meaning that there is a minority of very large positive values. And when data is extremely skewed, it may not be adequate for segmentation. In such a situation, it can be useful to convert it to a logarithmic scale.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># transform amount into a logarithmic scale and plot the result
</span><span class="n">new_data</span><span class="p">[</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log10</span><span class="p">(</span><span class="n">new_data</span><span class="p">[</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">])</span>
<span class="c1"># plot
</span><span class="n">ax</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">()</span>
<span class="n">new_data</span><span class="p">[</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">].</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="sh">'</span><span class="s">hist</span><span class="sh">'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">new_data</span><span class="p">[</span><span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">].</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="sh">'</span><span class="s">kde</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/logscale.png" style="zoom:100%;" />
<div class="thecap">  </div></div>

<p>From the plot above we can see that after the transformation our data became more symmetrical and less skewed.</p>

<p>Now we scale our data to ensure that the clustering algorithm is stable against outliers and extreme values. Not all machine learning algorithms require feature scaling. However, for distance-based algorithms such as HCA, KNN, K-means, or SVM, scaling is required. The reason is that all these algorithms use distances between data points to determine similarities.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Now we scale our data and we save it as dataframe:
</span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="nf">scale</span><span class="p">(</span><span class="n">new_data</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">new_data</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> 
                        <span class="n">columns</span><span class="o">=</span><span class="n">new_data</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># computing the distance would generate a huge matrix:
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Dimension of the distance matrix: (</span><span class="si">{</span><span class="n">new_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">new_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">)</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dimension of the distance matrix: (339185889, 3)
</code></pre></div></div>

<p>Calculating the distance matrix would generate a huge matrix. Therefore, we take a sample from our RFM dataset with a sampling rate of 10%. It means that only every 10th customer is considered in our segmentation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Since the distance matrix is that huge, 
# we are sampling with a sampling rate of 10%
</span><span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18417</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">sample</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])
</code></pre></div></div>

<p>Let’s display some random samples from our newly generated dataframe; the one we will use to perform hierarchical clustering.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_data_sample</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span>
<span class="n">new_data_sample</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------------+-----------+-------------+----------+
|   customer_id |   recency |   frequency |   amount |
|---------------+-----------+-------------+----------|
|         69760 |      3178 |           1 |  1.47712 |
|        147990 |      1911 |           1 |  1.30103 |
|        100510 |      2739 |           1 |  1.47712 |
|        138990 |        22 |           9 |  1.74473 |
|        258230 |        55 |           1 |        2 |
+---------------+-----------+-------------+----------+
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">customers_sample</span> <span class="o">=</span> <span class="n">customers</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sample</span><span class="p">].</span><span class="nf">copy</span><span class="p">()</span>
<span class="c1"># we compute the distances on the sampled data
</span><span class="n">d</span> <span class="o">=</span> <span class="nf">pdist</span><span class="p">(</span><span class="n">new_data_sample</span><span class="p">)</span> <span class="c1"># default metric is euclidean
# and we perform the hierarchical clustering:
</span><span class="n">hcward</span> <span class="o">=</span> <span class="nf">linkage</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">ward</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">pdist()</code> computes pairwise distances between observations. The default distance metric is Euclidean. There are, however, many other metrics to choose from, such as: <code class="language-plaintext highlighter-rouge">minkowski</code>, <code class="language-plaintext highlighter-rouge">chebyshev</code> and <code class="language-plaintext highlighter-rouge">hamming</code>. Here we choose the default method.</p>

<p>The clustering is performed by calling the <code class="language-plaintext highlighter-rouge">linkage()</code> using the <code class="language-plaintext highlighter-rouge">ward</code> method. There are many other methods to choose from and it doesn’t have to be <code class="language-plaintext highlighter-rouge">ward</code>.</p>

<p>After performing HCA we display the results using dendrogram.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Plot dendrogram
</span><span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">Customer Dendrogram - Truncated</span><span class="sh">"</span><span class="p">)</span>
<span class="n">dend</span> <span class="o">=</span> <span class="nf">dendrogram</span><span class="p">(</span><span class="n">hcward</span><span class="p">,</span> 
                  <span class="n">truncate_mode</span><span class="o">=</span><span class="sh">'</span><span class="s">lastp</span><span class="sh">'</span><span class="p">,</span>
                  <span class="n">p</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
                  <span class="n">show_contracted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">leaf_rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                  <span class="n">leaf_font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Customer ID</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Distance</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/dendrogram.png" style="zoom:100%;" />
<div class="thecap">  </div></div>

<h3 id="determining-the-number-of-clusters">Determining the Number of Clusters</h3>

<p>In RFM models it is usual to choose 11 clusters as recommended by <a href="https://bit.ly/32UPdhu">PULTER</a> and other experts. They also provide a well-documented customer segment table with the description of each segment as well as a list of marketing actions corresponding to each segment.</p>

<div class="imgcap">
<img src="/assets/6/rfms.png" style="zoom:100%;" />
<div class="thecap"> Table 1. Customer Segments - Source: putler [5] </div></div>

<p>However, it is not necessary to have 11 clusters.<br />
From the dendrogram we can see that 4 clusters make sense for this scenario as well as for simplicity sake. So let’s try that.</p>

<p>Remember: When it comes to cut-off selection there is no golden method on how to pick the perfect number of clusters. What matters is to use the right clustering approach for the business problem at hand and that your conclusions are actionable.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Cut at 4 clusters
</span><span class="n">members</span> <span class="o">=</span> <span class="nf">cut_tree</span><span class="p">(</span><span class="n">hcward</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># Assign to each customer a group
</span><span class="n">groups</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">unique</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">segments</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">counts</span><span class="p">))</span>

<span class="n">customers_sample</span><span class="p">[</span><span class="sh">'</span><span class="s">group</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">members</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()</span>
<span class="c1"># Create a table with the obtained groups and their characteristics
</span><span class="n">clusters</span> <span class="o">=</span> <span class="n">customers_sample</span><span class="p">[[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">group</span><span class="sh">'</span><span class="p">]].</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">group</span><span class="sh">'</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>
<span class="n">clusters</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------+-----------+-------------+----------+
|   group |   recency |   frequency |   amount |
|---------+-----------+-------------+----------|
|       0 |   2612.50 |        1.30 |    29.03 |
|       1 |    193.65 |       10.62 |    42.02 |
|       2 |    712.52 |        2.55 |    31.12 |
|       3 |    972.55 |        2.76 |   149.70 |
+---------+-----------+-------------+----------+
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Number of customers per segment: </span><span class="si">{</span><span class="n">segments</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of customers per segment: {0: 521, 1: 130, 2: 859, 3: 332}
</code></pre></div></div>
<h3 id="clusters-profiling">Clusters Profiling</h3>

<p>Now that we have our clusters and are convinced of their number, we can start profiling them. For this purpose we are going to use the Customer Segments table from putler.</p>

<ol>
  <li><strong>Group 0</strong> has the lowest recency, frequency and monetary value. Therefore, we refer to this group as <strong>Lost</strong>. You’d better ignore it completely.</li>
  <li><strong>Group 1</strong>  consists of your <strong>Loyal Customers</strong>. They buy often and spend a good money with us. As actionable tips I would suggest to Offer them higher value products, ask for reviews and create meaningful interactions with them, using engagement marketing strategies.</li>
  <li><strong>Group 2</strong> are the <strong>Customers Needing Attention</strong>. It’s by far your largest group, so you need to reconnect with the customers in this group. The sooner, the better; before they fall into the group “about to sleep”. You might, for instance, offer them limited-time product deals based on their past purchases.</li>
  <li><strong>Group 3</strong> contains the <strong>Can’t Lose Them</strong> customers. They spent the most money in our business, but haven’t come back for a long time. Win them back, talk to them, and don’t lose them to your competitors. Try to reengage them with your company through renewals or new products, or perhaps special marketing events.</li>
</ol>

<p>Let us include the profiling results in our <code class="language-plaintext highlighter-rouge">clusters</code> variable and create an appealing visualization of the findings. After all, it is your job as a business analyst to convince the management team to implement your recommendations for action.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clusters</span><span class="p">[</span><span class="sh">'</span><span class="s">n_customers</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">customers_sample</span><span class="p">[</span><span class="sh">'</span><span class="s">group</span><span class="sh">'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">clusters</span><span class="p">[</span><span class="sh">'</span><span class="s">cluster_names</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">lost</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">loyal</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">needing attention</span><span class="sh">'</span><span class="p">,</span> <span class="sh">"</span><span class="s">can</span><span class="sh">'</span><span class="s">t lose them</span><span class="sh">"</span><span class="p">]</span>

<span class="c1"># Visualization
</span><span class="n">plt</span><span class="p">.</span><span class="nf">set_cmap</span><span class="p">(</span><span class="sh">'</span><span class="s">hsv</span><span class="sh">'</span><span class="p">)</span>
<span class="n">clusters</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">recency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">amount</span><span class="sh">'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">squarify</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="n">clusters</span><span class="p">[</span><span class="sh">'</span><span class="s">n_customers</span><span class="sh">'</span><span class="p">],</span> 
              <span class="n">label</span><span class="o">=</span><span class="n">clusters</span><span class="p">[</span><span class="sh">'</span><span class="s">cluster_names</span><span class="sh">'</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">45</span> <span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">"</span><span class="s">RFM Segments</span><span class="sh">"</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="sh">'</span><span class="s">off</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div>

<div class="imgcap">
<img src="/assets/6/segments.png" style="zoom:110%;" />
<div class="thecap">  </div></div>

<h2 id="summary">Summary</h2>

<p>In this tutorial, we presented another use case of hierarchical clustering: Customer Segmentation based on buying behavior. It is a simple yet powerful technique when it comes to customer targeting and precision marketing.<br />
We also showed how clusters profiling works and how you can tailor your marketing campaigns to the customer segments whose expected profitability exceeds the cost to reaching them.  However, this segmentation method is not without problems and comes with a number of limitations:</p>

<ol>
  <li>New customers are constantly being added to the database, which requires frequent updating of the segmentation model.</li>
  <li>Clusters can capture seasonal customers buying behaviors, so results are no longer generalizable to different time periods.</li>
  <li>Frequent updates can be expensive. Unless they are automated and you don’t need each time to hire a data scientist.</li>
</ol>

<p>This is the main reason why companies are still reluctant to use statistical segmentation and prefer to rely on managerial segmentation.</p>

<p>Non-statistical segmentation approaches are based on simple rules and guidelines and rely heavily on subjective judgment. This also comes with some drawbacks, as it can be severely affected by various types of biases and cognitive limitations when processing complex data.<br />
 Which one you choose depends on your goals and budget. However, if you prefer the latter approach, I strongly recommend that you perform statistical segmentation, at least once as exploratory tool, to identify complex patterns in multivariate data sets. Then you can set up your segmentation rules around them.</p>
<h2 id="references">References</h2>

<ol>
  <li>Karl Melo. <a href="https://rstudio-pubs-static.s3.amazonaws.com/226524_10f550ea696f4db8a033c6583a8fc526.html">Customer Analytics I - Customer Segmentation</a>. 2016</li>
  <li>Navlani, A. <a href="https://www.datacamp.com/community/tutorials/introduction-customer-segmentation-python">Introduction to Customer Segmentation in Python</a>. datacamp, 2018.</li>
  <li>Lilien, Gary L, Arvind Rangaswamy, and Arnaud De Bruyn. 2017. Principles of Marketing Engineering and Analytics. State College, PA: Decisionpro.</li>
  <li>Jim Novo. <a href="https://www.jimnovo.com/RFM-tour.htm">Turning Customer Data into Profits</a></li>
  <li>Anish Nair. <a href="https://www.putler.com/rfm-analysis/">RFM Analysis For Successful Customer Segmentation</a>. putler, 2022.</li>
  <li>Kohavi, Ron, Llew Mason, Rajesh Parekh, and Zijian Zheng. 2004. “Lessons and Challenges from Mining Retail E-Commerce Data.” Machine Learning 57 (1/2): 83–113.</li>
  <li>Dataset from <a href="https://github.com/skacem/Business-Analytics/tree/main/Datasets">Github repo</a>. Accessed 25 October 2021.</li>
</ol>


  </article>

</div>

<center>
<b>tagged in</b>: [

  
  <a href="/tag/Business Analytics"><code class="highligher-rouge"><nobr>Business Analytics</nobr></code></a>

  
  <a href="/tag/Tutorial"><code class="highligher-rouge"><nobr>Tutorial</nobr></code></a>

  
  <a href="/tag/Hierarchical Cluster Analysis"><code class="highligher-rouge"><nobr>Hierarchical Cluster Analysis</nobr></code></a>

  
  <a href="/tag/Customer Segmentation"><code class="highligher-rouge"><nobr>Customer Segmentation</nobr></code></a>

]
</center>

<br><br>
<center>
<div class="share-page">
    <a href="https://twitter.com/intent/tweet?text=Customer Segmentation using RFM Analysis&url=/ml/2021/10/25/Customer-Segmentation-BA2/&via=&related=" target="_blank" title="Share on Twitter"> <img alt="Tweet" src="/assets/images/flat_web_icon_set/color/Twitter.png" /></a>
    <a href="http://www.reddit.com/submit?url=/ml/2021/10/25/Customer-Segmentation-BA2/" target="_blank" title="Share on Reddit"><img alt="Reddit" src="/assets/images/flat_web_icon_set/color/Reddit.png" /></a>
    <a href="http://www.linkedin.com/shareArticle?mini=true&url=/ml/2021/10/25/Customer-Segmentation-BA2/&title=Customer Segmentation using RFM Analysis&summary=&source=" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="/assets/images/flat_web_icon_set/color/LinkedIn.png" /></a>
    <a href="https://plus.google.com/share?url=/ml/2021/10/25/Customer-Segmentation-BA2/" target="_blank" title="Share on Google+"><img alt="Share on Google+" src="/assets/images/flat_web_icon_set/color/Google+.png"></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/ml/2021/10/25/Customer-Segmentation-BA2/&quote=Customer Segmentation using RFM Analysis" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="/assets/images/flat_web_icon_set/color/Facebook.png" /></a>
</div>
</center>

<div>
  <br>
  <center>
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
    </a>
    <br>
    Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> CC BY-NC-SA 4.0 International License</a>
  </center>
  <br>
</div>


  <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = '/ml/2021/10/25/Customer-Segmentation-BA2/'; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = /ml/2021/10/25/Customer-Segmentation-BA2/; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://skacem.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



      </div>
    </div>
    <footer class="site-footer">
  <div class="wrap">
    <div class="footer-top">
      <center>
      <ul>
        
          <li><a class="site-link" href="mailto:skanderkacem@gmail.com"><i class="fa fa-envelope-square fa-fw fa-2x"></i></a></li>
        

        

        
          <li><a class="site-link" href="https://github.com/skacem"><i class="fa fa-github-square fa-fw fa-2x"></i></a></li>
        

        

        

        <li><a class="site-link" href="/feed.xml"><i class="fa fa-rss-square fa-fw fa-2x"></i></a></li>
        <br>

      </center>
    </div>
    <div class="footer-bottom"></div>
  </div>
</footer>
    </body>
</html>