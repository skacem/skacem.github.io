<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Introduction to Web Scraping with Python</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="">
    <link rel="canonical" href="/ml/2021/06/25/Web-Crawlers/">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-96x96.png">

    <!--flattr.com -->
    <meta name="flattr:id" content="nlxxeo">

    <!-- Stuff added for BibTex dropdown menu -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

        <!--KaTeX-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
        <script>
         document.addEventListener("DOMContentLoaded", function() {
             renderMathInElement(document.body, {
                 // ...options...
             });
         });
        </script>
        
</head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MJT6KHN3F1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MJT6KHN3F1');
</script>
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" rel="stylesheet">

    <body>
    <a name="top"></a>
    <header class="site-header">
  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
      <a href="/about/">
    <img src="/sk.png" width="45">
  </a>
  </div>

    <a class="site-title site-link" href="/about/">Skander Kacem</a> <br>
    <p class="site-subtitle" style="font-style: italic; text-align: center;">Thinking out loud</p>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="site-link" href="/thoughts/">Thoughts</a>
        <a class="site-link" href="/readings/">Readings</a>
        <a class="site-link" href="/notes/">Notes</a>
      </div>
    </nav>
  </div>
</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Introduction to Web Scraping with Python</h1>
    <div class="post-meta">
      <div class="post-date">
        <i class="fa fa-calendar-o"></i>
        2021-06-25
      </div>
      <div class="post-tags">
        <i class="fa fa-tags"></i>
        
          <span><a href="/tag/Python"><code class="highligher"><nobr>Python</nobr></code></a></span>
        
          <span><a href="/tag/Web Crawler"><code class="highligher"><nobr>Web Crawler</nobr></code></a></span>
        
          <span><a href="/tag/BeautifulSoup"><code class="highligher"><nobr>BeautifulSoup</nobr></code></a></span>
        
      </div>
    </div>
  </header>

  <article class="post-content">
  <h2 id="overview">Overview</h2>

<p>Scraping is the process of extracting, copying, screening, or collecting data. It can be done manually or automated, using robots, spiders or crawlers. When it is automated, we usually talk about crawling. In this short introduction we use both words scraping and crawling synonymously and interchangeably. In case you would like to have more details about the differences, I recommend following blog article: <a href="https://oxylabs.io/blog/crawling-vs-scraping">Web Scraping vs Web Crawling: The Differences</a> by Gabija Fatenaite.</p>

<p>Crawlers capture different kind of data:</p>

<ul>
  <li>HTML files,</li>
  <li>JSON strings,</li>
  <li>Various binary data, such as pictures, videos, audios, …</li>
  <li>Web rendering files, such as CSS, JavaScript and other configuration files.</li>
</ul>

<p>It’s important to know what files are captured by the crawler, so to save them in the right format. To extract the data we need also to analyze the code source. This require some basic understanding of HTML/CSS and the DOM tree structure. <br />
Regarding JavaScripts, we can analyze the back-end Ajax interface, or use libraries such as Selenium and splash to simulate the implemented JavaScript rendering.</p>

<h2 id="the-composition-of-a-web-page">The composition of a Web Page</h2>

<p>Web pages can be divided into three skeletons:</p>

<ol>
  <li>HTML (Hypertext Markup Language)</li>
  <li>CSS (Cascading Style Sheet)</li>
  <li>JavaScript: for dynamic and interactive page functions</li>
</ol>

<p>The standard form of a web page is head and body tags nested inside html tags, with the head defining the configuration and references of the page and the body defining the body of the page. According to the W3C HTML DOM standard, everything in an HTML document is a node (see <a href="https://www.w3schools.com/">w3schools</a>):</p>

<ul>
  <li>The entire document is a document node</li>
  <li>Every HTML element is an element node</li>
  <li>The text inside HTML elements are text nodes</li>
  <li>Every HTML attribute is an attribute node (deprecated)</li>
  <li>All comments are comment nodes</li>
</ul>

<div class="imgcap">
<img src="/assets/2/htmltree.gif" style="zoom:115%" alt="HTML DOM" />
<div class="thecap"> HTML DOM Tree Instance  (Source: <a href="https://www.w3schools.com/js/js_htmldom_navigation.asp">w3schools.com</a>)</div>
</div>

<p>Document Object Model (DOM): allows programs and scripts to dynamically access and update the content, structure, and style of a document.</p>

<h2 id="selectors">Selectors</h2>

<p>With the HTML DOM, all nodes in the node tree can be accessed by JavaScript. New nodes can be created, and all nodes can be modified or deleted. A node can be text, comments, or elements. Usually, when we access content in the DOM, we use HTML element selectors. In order to be proficient at accessing elements in the DOM, it is necessary to have a basic knowledge of CSS selectors and syntax. This is out of scope of this article, however in the following table are some of the CSS selectors depicted:</p>

<table>
  <thead>
    <tr>
      <th>Selector</th>
      <th>Example       </th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>.class</td>
      <td>.intro</td>
      <td>Select all nodes with class=”intro”</td>
    </tr>
    <tr>
      <td>#id</td>
      <td>#fname</td>
      <td>Select all nodes with id=”fname”</td>
    </tr>
    <tr>
      <td>element</td>
      <td>p</td>
      <td>Select all p nodes</td>
    </tr>
    <tr>
      <td>element,element</td>
      <td>div,p</td>
      <td>Select all div nodes and all p nodes</td>
    </tr>
    <tr>
      <td>element element</td>
      <td>div p</td>
      <td>Select all p nodes inside the div node</td>
    </tr>
    <tr>
      <td>element&gt;element</td>
      <td>div&gt;p</td>
      <td>Select all p nodes whose parent node is div node</td>
    </tr>
    <tr>
      <td>element+element   </td>
      <td>div+p   </td>
      <td>Select all p nodes immediately after the div node    </td>
    </tr>
  </tbody>
</table>

<h2 id="https---some-basics">HTTP(S) - Some Basics</h2>

<p>Hyper Text Transfer Protocol (HTTP) is an application protocol used to transfer hypertext data  such as HTML from the web to the local browser. The communication consists of a request message from the client to the web server, followed by an HTTP response, which can be rendered by the browser. HTTP is, in fact, a rather simple networking protocol. It is text based and stateless, following a request-reply communication scheme.</p>

<div class="imgcap">
<img src="/assets/2/req-resp.png" style="zoom:75%;" alt="HTTP Request and Response" />
<div class="thecap"> HTTP Requests and Responses Share Similar Structure (Source: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages">mozilla.org</a>) </div>
</div>

<h3 id="http-request">HTTP Request</h3>

<p>The request is sent from the client to the server and is organized into 4 parts: request method, request URL, request header and request body. The most commonly used request methods are POST, GET, PUT, DELETE and PATCH and are similar to the database CRUD.
The request header is used to describe additional information. Some of the more important information are Cookies and User-Agent.<br />
It’s the request header that has to be specified when it comes to building crawlers, since the request body in the GET method is usually empty.</p>

<h3 id="http-response">HTTP Response</h3>

<p>The response is returned to the client by the server and is divided into three parts: the response status code, the response header and the response body.<br />
The response status code indicates a successful or failed request. In case of 200, the resource data requested by the client is in the response body.</p>

<p>Selected status codes:</p>

<table>
  <thead>
    <tr>
      <th>Code    </th>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
      <td>OK</td>
      <td>The request is OK</td>
    </tr>
    <tr>
      <td>400</td>
      <td>Bad Request</td>
      <td>Server unable to understand the request</td>
    </tr>
    <tr>
      <td>401</td>
      <td>Unauthorized   </td>
      <td>Requested content needs authentication credentials   </td>
    </tr>
    <tr>
      <td>403</td>
      <td>Forbidden</td>
      <td>Access is forbidden</td>
    </tr>
    <tr>
      <td>404</td>
      <td>Not Found</td>
      <td>Server is unable to find the requested page</td>
    </tr>
  </tbody>
</table>

<h3 id="stateless-http">Stateless HTTP</h3>

<p>Stateless HTTP means that the HTTP protocol has no memory of service delivery, which means that the server does not know the client’s state. When we send a request to the server, the server processes the request and returns the corresponding response, the server is responsible for completing this process, and this process is completely independent, the server does not record the change of state before and after, that is, there is no state record.</p>

<h3 id="cookies-and-sessions">Cookies and Sessions</h3>

<p>Cookies are data stored on the user’s local browser by some websites for the purpose of identifying and tracking the user’s session.<br />
The first time a browser connects with a particular server, there are no cookies. 
When the server responds it includes a header that defines a cookie. Each cookie is a name-value pair. Each time the browser connects with the same server, it includes the cookie in HTTP request. The server recognize the cookie and identify the user.</p>

<h2 id="urllib-vs-requests">Urllib vs Requests</h2>

<p><code class="language-plaintext highlighter-rouge">urllib</code> is a python stdandard library, that collects several modules for working with URLs. So it works out of the box and you don’t have to deal with package compatibility issues and has the basic modules to start scraping the web such as:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">urllib.request</code> for opening and reading URLs</li>
  <li><code class="language-plaintext highlighter-rouge">urllib.error</code> containing the exceptions raised by urllib.request</li>
  <li><code class="language-plaintext highlighter-rouge">urllib.parse</code> for parsing URLs</li>
  <li><code class="language-plaintext highlighter-rouge">urllib.robotparser</code> for parsing robots.txt files</li>
</ul>

<p>However, when it comes to higher level HTTP client interfaces and requests <code class="language-plaintext highlighter-rouge">requests</code> is recommended (by the official python docs). Indeed <code class="language-plaintext highlighter-rouge">requests</code> package is very useful and was designed to do just that. Moreover:</p>

<ul>
  <li>it supports a fully restful API,</li>
  <li>it comes with very short commands:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">http://www.mywebsite.com/user</span><span class="sh">'</span><span class="p">)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="sh">'</span><span class="s">http://www.mywebsite.com/user</span><span class="sh">'</span><span class="p">)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="sh">'</span><span class="s">http://www.mywebsite.com/user/put</span><span class="sh">'</span><span class="p">)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="sh">'</span><span class="s">http://www.mywebsite.com/user/delete</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li>it takes a dictionary as argument and</li>
  <li>it has it own built in JSON decoder.</li>
</ul>

<p>Now that we have the background knowledge needed to understand and implement crawlers let’s build our very first one.</p>

<h2 id="building-your-first-crawler">Building Your First Crawler</h2>

<p>Let’s build a crawler to extract the 3 top movies of all time of each genre. That sounds like fund, doesn’t? Let’s do that.</p>

<p>First we need to install the following three packages:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">requests</code>,</li>
  <li><code class="language-plaintext highlighter-rouge">beautifulsoup</code> and</li>
  <li><code class="language-plaintext highlighter-rouge">lxml</code>.</li>
</ol>

<p>That can be done with the following bash commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>bs4
pip <span class="nb">install </span>requests
pip <span class="nb">install </span>lxml
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">BeautifulSoup</code> module is used to parse the <code class="language-plaintext highlighter-rouge">HTML</code> and extract the information from it. <code class="language-plaintext highlighter-rouge">Beautifulsoup</code> does a great job at fixing and formatting the broken HTML codes into a HTML DOM Tree Instance, that is then easy to traverse using Python. The <code class="language-plaintext highlighter-rouge">lxml</code> on the other hand, is the parser. We tend to use <code class="language-plaintext highlighter-rouge">lxml</code>  even for <code class="language-plaintext highlighter-rouge">HTML</code> files, since it offers more flexibilities and robustness against HTML syntax errors, such as unclosed tags, improperly nested tags, and missing head or body tags. The only disadvantage of <code class="language-plaintext highlighter-rouge">lxml</code> it that it has to be installed separately, which can cause problems in terms of code portability.</p>

<p>There are basically three steps to web scraping:</p>

<ol>
  <li>Fetching the host site</li>
  <li>Parsing and extracting information</li>
  <li>Saving the information (as csv, json or in a DB)</li>
</ol>

<p>First let’s start by importing the needed python modules:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bs</span>
</code></pre></div></div>

<p>now let’s define the genre and the URL we want to fetch:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre</span> <span class="o">=</span> <span class="sh">'</span><span class="s">animation</span><span class="sh">'</span>
<span class="n">link</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://www.rottentomatoes.com/top/bestofrt/top_100_</span><span class="sh">'</span> <span class="o">+</span> <span class="n">genre</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_movies/</span><span class="sh">'</span>
</code></pre></div></div>

<p>When requesting access to the content of a webpage, sometimes you will get a 403 error response. This is because the server has an anti-crawler installed. To overcome it, you need to simulate the browser header:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">user-agent</span><span class="sh">'</span><span class="p">:</span> 
    <span class="sh">'</span><span class="s">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.82 Safari/537.36</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">Cache-Control</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">no-cache</span><span class="sh">'</span>
<span class="p">}</span>
<span class="c1"># requesting connection with the target link
</span><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</code></pre></div></div>

<p>Let’s print the response status code from the server, to see if the page was downloaded successfully:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Response status code: </span><span class="si">{</span><span class="n">r</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Response status code: 200
</code></pre></div></div>

<p>A status code 200 means that the page downloaded successfully.<br />
Now we can create our BeautifulSoup object:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span> <span class="o">=</span> <span class="nf">bs</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="sh">"</span><span class="s">lxml</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<p>BeautifulSoup module comes with three methods to find elements:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">findall()</code>: find all nodes</li>
  <li><code class="language-plaintext highlighter-rouge">find()</code>: find a single node</li>
  <li><code class="language-plaintext highlighter-rouge">select()</code>: CSS Selector</li>
</ul>

<p>In order to extract the needed information we have to understand the DOM structure of the target webpage and locate the element tag of the movie titles. To do so, we use the browser devtool as shown below:</p>

<div class="imgcap">
<img src="/assets/2/devtool.gif" style="zoom:50%;" alt="Browser's DevTool in action" />
<div class="thecap"> DevTool in Action </div>
</div>

<p>As we can see, all the movies are listed under the element <code class="language-plaintext highlighter-rouge">table</code> with the class attribute <code class="language-plaintext highlighter-rouge">table</code> and the titles are under the element <code class="language-plaintext highlighter-rouge">a</code> with the class attribute <code class="language-plaintext highlighter-rouge">unstyled articleLink</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">movies</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">).</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="sh">"</span><span class="s">unstyled articleLink</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>That’s it we are done.</p>

<p>Let’s get it all together:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="k">as</span> <span class="n">bs</span>

<span class="k">def</span> <span class="nf">top_100_movies</span><span class="p">(</span><span class="n">genre</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">user-agent</span><span class="sh">'</span><span class="p">:</span> 
        <span class="sh">'</span><span class="s">Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.82 Safari/537.36</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">Cache-Control</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">no-cache</span><span class="sh">'</span>
    <span class="p">}</span>
    
    <span class="n">link</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://www.rottentomatoes.com/top/bestofrt/top_100_</span><span class="sh">'</span> <span class="o">+</span> <span class="n">genre</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_movies/</span><span class="sh">'</span>
    <span class="n">movie_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="nf">bs</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="sh">"</span><span class="s">lxml</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">movies</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">).</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="sh">"</span><span class="s">unstyled articleLink</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span>
        <span class="n">movie_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="nf">getText</span><span class="p">().</span><span class="nf">strip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">movie_list</span>
</code></pre></div></div>
<p>Because it is prettier in a function and it’s more useful in case you are looking for all time best movies of another genre or all genres such as below:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genres</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">animation</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">horror</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">drama</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">comedy</span><span class="sh">'</span><span class="p">,</span> 
              <span class="sh">'</span><span class="s">classics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">documentary</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">romance</span><span class="sh">'</span><span class="p">,</span>
             <span class="sh">'</span><span class="s">mystery__suspense</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">action__adventure</span><span class="sh">'</span><span class="p">,</span>
             <span class="sh">'</span><span class="s">science_fiction__fantasy</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">art_house__international</span><span class="sh">'</span><span class="p">]</span>


<span class="c1"># 3 top movies in each category
</span><span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">genres</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">genre</span><span class="p">.</span><span class="nf">title</span><span class="p">().</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">__</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s"> &amp; </span><span class="sh">'</span><span class="p">)</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">top_100_movies</span><span class="p">(</span><span class="n">genre</span><span class="p">)[</span><span class="si">:</span><span class="mi">3</span><span class="p">])</span><span class="si">}</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Animation: Toy Story 4 (2019), Spider-Man: Into the Spider-Verse (2018), Inside Out (2015).
Horror: Us (2019), Get Out (2017), The Cabinet of Dr. Caligari (Das Cabinet des Dr. Caligari) (1920).
Drama: Black Panther (2018), Citizen Kane (1941), Parasite (Gisaengchung) (2019).
Comedy: It Happened One Night (1934), Modern Times (1936), Toy Story 4 (2019).
Classics: It Happened One Night (1934), Modern Times (1936), Citizen Kane (1941).
Documentary: Won't You Be My Neighbor? (2018), I Am Not Your Negro (2017), Apollo 11 (2019).
Romance: It Happened One Night (1934), Casablanca (1942), The Philadelphia Story (1940).
Mystery &amp; Suspense: Citizen Kane (1941), Knives Out (2019), Us (2019).
Action &amp; Adventure: Black Panther (2018), Avengers: Endgame (2019), Mission: Impossible - Fallout (2018).
Science_Fiction &amp; Fantasy: Black Panther (2018), The Wizard of Oz (1939), Avengers: Endgame (2019).
Art_House &amp; International: Parasite (Gisaengchung) (2019), The Cabinet of Dr. Caligari (Das Cabinet des Dr. Caligari) (1920), Seven Samurai (Shichinin no Samurai) (1956).
</code></pre></div></div>

<p>I hope that wasn’t too confusing. At least you’ve got a nice list of movies to watch next.<br />
If you want to learn more about web scraping you can visit the following <a href="https://github.com/skacem/TIL/tree/main/Python/Web%20Scraping">repos</a>.</p>

<h2 id="references">References</h2>

<ol>
  <li><a href="https://web.stanford.edu/~ouster/cgi-bin/cs142-winter15/lectures.php">CS 142: Web Applications</a>, by John Ousterhout, Stanford University</li>
  <li><a href="https://www.digitalocean.com/community/tutorials/">Digitalocean</a> community tutorials</li>
  <li>Mitchell, R. 2018. Web Scraping with Python: Collecting More Data from the Modern Web. O’Reilly Media.</li>
</ol>

  </article>

</div>

<center>
<b>tagged in</b>: [

  
  <a href="/tag/Python"><code class="highligher-rouge"><nobr>Python</nobr></code></a>

  
  <a href="/tag/Web Crawler"><code class="highligher-rouge"><nobr>Web Crawler</nobr></code></a>

  
  <a href="/tag/BeautifulSoup"><code class="highligher-rouge"><nobr>BeautifulSoup</nobr></code></a>

]
</center>

<br><br>
<center>
<div class="share-page">
    <a href="https://twitter.com/intent/tweet?text=Introduction to Web Scraping with Python&url=/ml/2021/06/25/Web-Crawlers/&via=&related=" target="_blank" title="Share on Twitter"> <img alt="Tweet" src="/assets/images/flat_web_icon_set/color/Twitter.png" /></a>
    <a href="http://www.reddit.com/submit?url=/ml/2021/06/25/Web-Crawlers/" target="_blank" title="Share on Reddit"><img alt="Reddit" src="/assets/images/flat_web_icon_set/color/Reddit.png" /></a>
    <a href="http://www.linkedin.com/shareArticle?mini=true&url=/ml/2021/06/25/Web-Crawlers/&title=Introduction to Web Scraping with Python&summary=&source=" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="/assets/images/flat_web_icon_set/color/LinkedIn.png" /></a>
    <a href="https://plus.google.com/share?url=/ml/2021/06/25/Web-Crawlers/" target="_blank" title="Share on Google+"><img alt="Share on Google+" src="/assets/images/flat_web_icon_set/color/Google+.png"></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/ml/2021/06/25/Web-Crawlers/&quote=Introduction to Web Scraping with Python" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="/assets/images/flat_web_icon_set/color/Facebook.png" /></a>
</div>
</center>

<div>
  <br>
  <center>
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
    </a>
    <br>
    Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> CC BY-NC-SA 4.0 International License</a>
  </center>
  <br>
</div>


  <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = '/ml/2021/06/25/Web-Crawlers/'; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = /ml/2021/06/25/Web-Crawlers/; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://skacem.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



      </div>
    </div>
    <footer class="site-footer">
  <div class="wrap">
    <div class="footer-top">
      <center>
      <ul>
        
          <li><a class="site-link" href="mailto:skanderkacem@gmail.com"><i class="fa fa-envelope-square fa-fw fa-2x"></i></a></li>
        

        

        
          <li><a class="site-link" href="https://github.com/skacem"><i class="fa fa-github-square fa-fw fa-2x"></i></a></li>
        

        

        

        <li><a class="site-link" href="/feed.xml"><i class="fa fa-rss-square fa-fw fa-2x"></i></a></li>
        <br>

      </center>
    </div>
    <div class="footer-bottom"></div>
  </div>
</footer>
    </body>
</html>